# Copier configuration settings
_subdirectory: template
_min_copier_version: "9.1.0"
_message_after_copy: | 
    Your package "{{ name }}" has been created successfully!
    
    Next steps:
    
    1. (Optional) Ensure that git is initialized in the project root, if not:

       $ git init

    2. Generate a uv.lock file:

       $ uv lock

    3. Read README.md and start coding.

#######################################################################################################################
# 1. Questions for the package maintainers
#######################################################################################################################
name:
    type: str
    help: What is the package name?
    validator: >-
        {% if not name %}
        Name is required.
        {% elif not (name | regex_search('^[a-zA-Z](?:[a-zA-Z0-9]| (?![ ]))*$')) %}
        Only alphanumeric characters and single spaces are allowed.
        {% endif %}

description:
    type: str
    help: What does the package do?
    placeholder: "A Python package that ..."

package_type:
    type: str
    help: What package type do you want to create?
    choices:
        Python Package: package
        Django App: django
        FastAPI App: fastapi
        Gradio App: gradio
        Streamlit App: streamlit
    default: package

use_pydantic:
    type: bool
    help: Do you want to use Pydantic (y/N)?
    default: "{% if package_type == 'fastapi' %}yes{% else %}no{% endif %}"
    when: "{{ package_type != 'fastapi' }}"

use_makefile:
    type: bool
    help: Do you want to use a Makefile with convenient shortcuts (y/N)?
    default: no

#######################################################################################################################
# 1.2 Setup CI/CD
#######################################################################################################################
ci:
    type: str
    help: What Continuous Integration service do you want to use?
    choices:
        GitHub CI: github
        GitLab CI: gitlab
        No CI: none
    default: github

repository_url:
    type: str
    help: What is the URL of this repository?
    default: "{% if ci == 'github' %}https://github.com/<username>/<repo>/{% else %}https://gitlab.com/<username>/<repo>/{% endif %}"
    validator: >-
        {% if ci == 'github' and not (repository_url | trim | regex_search('^https://github\\.com/[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+/$')) %}
        Invalid GitHub URL, example: https://github.com/lukin0110/poetry-copier-fastapi-demo/
        {% elif ci == 'gitlab' and not (repository_url | regex_search('^https://gitlab\\.com/[a-zA-Z0-9/_-]+/$')) %}
        Invalid GitHub URL, example: https://gitlab.com/lukin0110/poetry-copier-fastapi-gitlab-demo/
        {% elif not repository_url %}
        Repository URL is required.
        {% endif %}

#######################################################################################################################
# 2. Computed or fixed values
# Compute, don't prompt. https://github.com/copier-org/copier/issues/716#issuecomment-1263307193
#######################################################################################################################
python_version:
    type: str
    help: What Python version do you want to use?
    default: "3.14.3"
    when: false

uv_version:
    type: str
    help: What uv version do you want to use?
    default: "0.10.7"
    when: false

# The validator of the `name` field ensures that the name only contains alphanumeric characters and single spaces.
package_slug:
    type: str
    help: A slug of the package name?
    default: "{{ name | lower | trim | replace(' ', '_') }}"
    when: false

use_app:
    type: bool
    help: Do you want to use the app (y/N)?
    default: "{% if package_type != 'package' %}yes{% else %}no{% endif %}"
    when: false

use_django:
    type: bool
    help: Do you want to use Django (y/N)?
    default: "{% if package_type == 'django' %}yes{% else %}no{% endif %}"
    when: false

use_fastapi:
    type: bool
    help: Do you want to use FastAPI (y/N)?
    default: "{% if package_type == 'fastapi' %}yes{% else %}no{% endif %}"
    when: false

use_gradio:
    type: bool
    help: Do you want to use Gradio (y/N)?
    default: "{% if package_type == 'gradio' %}yes{% else %}no{% endif %}"
    when: false

use_streamlit:
    type: bool
    help: Do you want to use Streamlit (y/N)?
    default: "{% if package_type == 'streamlit' %}yes{% else %}no{% endif %}"
    when: false

use_push_ecr:
    type: bool
    help: Do you want to push the Docker image to ECR (y/N)?
    default: no
    when: false
